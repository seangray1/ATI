<!--
  @Page Name          : InvoicePDFTemplate.page
  @Description        : 
  @Author             : sean.gray@atirestoration.com
  @Group              : 
  @Last Modified By   : sean.gray@atirestoration.com
  @Last Modified On   : 8/14/2019, 12:54:12 PM
  @Modification Log   : 
  ==============================================================================
  Ver         Date                     Author                 Modification
  ==============================================================================
  1.0    8/12/2019, 3:34:56 PM   sean.gray@atirestoration.com     Initial Version
-->
<apex:page id="invoicePDF"
        standardController="Invoice__c"
        extensions="InvoicePDFController"
        showHeader="false"
        renderAs="pdf"
        cache="false" applyBodyTag="false">
        
    <head>
        <apex:stylesheet value="{!$Resource.InvoiceStyle}"/>
        <style type="text/css" media="print">
            /* Generates the header and footer content on every page */
            @page {
                margin: 1.260in 0.35in 0 0.35in;
                size: letter portrait;
                
                @top-center {
                    width: 8.5in;
                    content: element(header);
                }
                /*@bottom-center {
                    width: 8.5in;
                    content: element(footer);
                }*/
            }
            div.header {
                background: url("{!URLFOR($Resource.InvoicePDFImages,'HeaderBg.png')}") no-repeat top right;

                height: 7.5in;
                width: 111%;
                display: block;
                padding-top: 20px; 
                position: running(header);
                margin-left: -0.5in;
                padding-left: 0.5in;
            }
            div.footer {
                width: 111%;
                display: block;
                border-top:1px dashed #231f20;;
                padding: 0 0 0.5in;
                /*position: running(footer);*/
                margin-left: -0.5in;
            }
            a,p,div,td,th,span {
                 font-family:Arial,Helvetica,sans-serif;
                 font-size:10pt;
            }
            .headerTitle {
                 font-family:Arial,Helvetica,sans-serif;
                 font-size:9pt !important;
            }
            .footerTbl{border-top:1px solid #1d376c; border-right:1px solid #1d376c; }
            .footerTbl td{border-left:1px solid #1d376c; border-bottom:1px solid #1d376c; padding:5px;}
            .OpStyle{font-size:4pt!important;}
            a:link{font-size:7pt;}
        </style>
    </head>
     
    <div id="bodyWrapper" style="width:100%; height:100%;">
        <div class="bg"></div>
        <!-- Overarching template table.  It contains the letterhead as well
             as some heading information -->
        <div class="header">
        <table style="width:100%; height:1.55in; overflow:visible; ">
            <tr>
                <td style="width:3.5in; height:1.5in; text-align:left; vertical-align:top;"> <!-- Letterhead space -->
                    <apex:outputPanel layout="none" rendered="{!params.displayLetterhead}"> 
                        <img src="{!URLFOR($Resource.InvoicePDFImages,'ATILogo.png')}" width="100%" />
                    </apex:outputPanel>
                </td>
                <td style="vertical-align:top; padding-top:0.5in; width:2.05in">
                    <!-- <div style="width:1.4in;">&nbsp;</div>
                    <apex:outputPanel layout="none" rendered="{!params.displayLetterhead}"> 
                        <span style="color:#333; font-size:3em; font-weight:bold; text-decoration:underline;">INVOICE</span>
                    </apex:outputPanel> -->
                </td>
                <td style="vertical-align:top; padding-top:0.10in; font-size:9px; font-family:Arial,Helvetica,sans-serif;">
                    <table>
                        <tr>
                            <td style="text-align:left; font-size:9px; font-family:Arial,Helvetica,sans-serif;" class="headerTitle">Customer ID:</td>
                            <td style="text-align:left;" class="headerTitle">{!invoice.Bill_To__r.Timberline_Customer_Number__c}</td>
                        </tr>
                        <tr>
                            <td style="text-align:left;" class="headerTitle">Invoice ID:</td>
                            <td style="text-align:left;" class="headerTitle">{!invoice.Name}</td>
                        </tr>
                        <tr>
                            <td style="text-align:left;" class="headerTitle">Invoice Date:</td>
                            <td style="text-align:left;" class="headerTitle"> 
                                <apex:outputText value="{0,date,MM'/'dd'/'yyyy}">
                                    <apex:param value="{!invoice.Due_Date__c}" /> 
                                </apex:outputText>
                            </td>
                        </tr>
                        <tr>
                            <td style="text-align:left;" class="headerTitle">Invoice Due Date:</td>
                            <td style="text-align:left;" class="headerTitle"> 
                                <apex:outputText value="{0,date,MM'/'dd'/'yyyy}">
                                    <apex:param value="{!invoice.Due_Date_New__c}" /> 
                                </apex:outputText>
                            </td>
                        </tr>
                        <tr>
                            <td style="text-align:left;" class="headerTitle">Federal ID:</td>
                            <td style="text-align:left;" class="headerTitle">{!invoice.Federal_ID__c}</td>
                        </tr>
                    </table>
                </td>
            </tr>
            <apex:outputPanel layout="none" rendered="{!NOT(invoice.Status__c == 'final')}"> 
                <tr>
                    <td colspan="3" style="height:6in; text-align:center;">
                        <!-- <span style="font-size:10em; color:#999; opacity:0.3;">DRAFT</span> -->
                    </td>
                </tr>
            </apex:outputPanel>
        </table>
        </div>  
        
        <div class="body">
        <table>
            <tr>
                <td colspan="3">
                    <!-- This should be the "body" (anything which will not
                         repeat on each page).  It should be used via an
                         apex:composition tag defining the name "body" -->
                    <apex:insert name="body" />
                </td>
            </tr>
        </table>
        </div>
        
        <div class="footer">
        <!-- <apex:outputPanel rendered="{!params.displayLetterhead}"> -->
        <table style="width:7.6in; margin:1px 0 0 0.6in;">
            <tr>
                <td colspan="2" style="font-size:7pt; color:#231f20; text-align:center;">Please detach and submit this bottom portion with your payment</td>
            </tr>
            <tr>
                <td style="wdith:40%; font-size:9.5pt; line-height:1.4; padding:5px 0 0 0; vertical-align:top; margin-top:10px;">
                   <div style="padding-left:15px;">
                        <!-- Customer Name:<br/> -->
                        <apex:outputPanel layout="none" >
                            <apex:outputPanel rendered="{!NOT(ISBLANK(invoice.Bill_To_Attention__c))}">
                                <apex:outputText value="{!invoice.Bill_To_Attention__c}"></apex:outputText>
                                <br/>
                            </apex:outputPanel>
                            <apex:outputPanel rendered="{!NOT(ISBLANK(invoice.Bill_To_Attention_Line_2__c))}">
                                <apex:outputText value="{!invoice.Bill_To_Attention_Line_2__c}"></apex:outputText>
                                <br/>
                            </apex:outputPanel>
                            <apex:outputPanel rendered="{!AND( invoice.Bill_To__c != null, NOT(invoice.Omit_Bill_To__c))}">
                                <apex:outputText value="{!invoice.Bill_To__r.Name}" /><br/>
                            </apex:outputPanel>
                            <apex:outputPanel rendered="{!AND( invoice.Bill_To_Attention_Lookup__c != null, 
                                                               ( invoice.Bill_To__r.Name != invoice.Bill_To_Attention_Lookup__r.FirstName + ' ' + invoice.Bill_To_Attention_Lookup__r.LastName ),
                                                               OR(invoice.Bill_To_Attention__c == null, invoice.Omit_Bill_To__c),
                                                                  ISBLANK(invoice.Bill_To_Attention__c), 
                                                                  ISBLANK(invoice.Bill_To_Attention_Line_2__c))}">
                                <apex:outputText value="{!invoice.Bill_To_Attention_Lookup__r.FirstName} {!invoice.Bill_To_Attention_Lookup__r.LastName}" />
                                <br/>
                            </apex:outputPanel>
                        </apex:outputPanel>
                        <apex:outputPanel layout="none" rendered="{!AND(NOT(ISBLANK(invoice.Bill_To_Address_Formula__c)), ISBLANK(invoice.Care_Of__c))}">
                            <apex:outputText value="{!invoice.Bill_To_Address_Formula__c}" escape="false" /><br/>
                        </apex:outputPanel>
                         <apex:outputPanel layout="none" rendered="{!NOT(ISBLANK(invoice.Care_Of__c))}">
                            <apex:outputText escape="false" value="C/O {!invoice.Care_Of__r.Name}" /><br/>
                             <apex:outputText escape="false" value="{!invoice.Care_of_Address_Formula__c}" /><br/>
                        </apex:outputPanel>
                        <apex:outputPanel layout="none" rendered="{!NOT(ISBLANK(invoice.CC_CareOf__c))}">  
                            <apex:outputText escape="false" value="{!SUBSTITUTE(invoice.CC_Address_Care_of_Formula__c, '\n', '<br/>')}" /><br/>
                        </apex:outputPanel>

                         <apex:outputPanel layout="none" rendered="{!(ISBLANK(invoice.CC_Account__c))}">  
                            <apex:outputText escape="false" value="{!SUBSTITUTE
                            (invoice.CC_Address_Lookup__c, '\n', '<br/>')}" /><br/>
                        </apex:outputPanel> 
                     </div> 
                     <div style="margin-top:35px;">
                         MAIL TO:
                         <div style="padding-left:50px; margin-top:8px; font-size:11pt;">
                             <strong>American Technologies, Inc.</strong><br/>P.O. Box 8318<br/>Pasadena, CA 91109-8318
                         </div>
                     </div>
                </td>
                <td style="width:49%; vertical-align:top; margin-top:10px; padding-top:5px;">
                    <table class="footerTbl" style="width:100%;" cellspacing="0" cellpadding="0">
                        <tr>
                            <td style="width:72%;">
                                <img src="{!URLFOR($Resource.InvoicePDFImages,'FooterLog.png')}" width="94%" />
                            </td>
                            <td style="font-size:8pt; font-weight:normal;">
                                <div style="color:#231f20;font-size:8pt; margin-bottom:3px;">Amount enclosed:</div>
                                <span class="OFStyle"><apex:outputField styleClass="OFStyle" value="{!invoice.Net_Due__c}"/></span>
                                
                            </td>
                        </tr>
                        <tr>
                            <td style="padding:0px; vertical-align:top;">
                               <table style="width:100%; font-size:9px; padding:0px;" cellspacing="0" cellpadding="0">
                                   <tr>
                                       <th style="border:none; color:#fff; background:#1d376c;font-size:8pt; padding:2px 0; text-align:center;">INVOICE#</th>
                                       <th style="border:none; color:#fff; background:#1d376c;font-size:8pt; padding:2px 0; text-align:center;">INVOICE DATE</th>
                                       <th style="border:none; color:#fff; background:#1d376c;font-size:8pt; padding:2px 0; text-align:center;">TOTAL DUE</th>
                                   </tr>
                                   <tr>
                                       <td style="border:none;font-size:8pt; text-align:center;">{!invoice.Name}</td>
                                       <td style="border:none;font-size:8pt; text-align:center;">
                                           <apex:outputText value="{0,date,MM'/'dd'/'yyyy}">
                                            <apex:param value="{!invoice.Due_Date__c}" /> 
                                        </apex:outputText>
                                       </td>
                                       <td style="border:none;font-size:8pt; text-align:center; font-weight:normal;">
                                           <span class="OFStyle"><apex:outputField value="{!invoice.Net_Due__c}"/></span>
                                       </td>
                                   </tr>
                               </table> 
                            </td>
                            <td style="font-size:8px; font-weight:thin; text-align:center; color:#231f20;">
                                If you are authorizing a different amount, cross out amount above and enter new amount
                            </td>
                        </tr>
                    </table>
                    <div style="display:inline-block; margin:17px 5px 0 0; vertical-align:middle; font-size:8pt; color:#231f20;"><span style="display:inline-block; width:16px; height:16px; border:1.3px solid #231f20; margin:-5px 4px; 0 0"></span>Check enclosed</div><br/>
                    <div style="display:inline-block; margin:17px 5px 0 0; vertical-align:middle; font-size:8pt; color:#231f20;"><span style="display:inline-block; width:16px; height:16px; border:1.3px solid #231f20; margin:-5px 4px; 0 0"></span>VISA</div>
                    <div style="display:inline-block; margin:17px 5px 0 0; vertical-align:middle; font-size:8pt; color:#231f20;"><span style="display:inline-block; width:16px; height:16px; border:1.3px solid #231f20; margin:-5px 4px; 0 0"></span>AMEX</div>
                    <div style="display:inline-block; margin:17px 5px 0 0; vertical-align:middle; font-size:8pt; color:#231f20;"><span style="display:inline-block; width:16px; height:16px; border:1.3px solid #231f20; margin:-5px 4px; 0 0"></span>Mastercard</div>
                    <div style="display:inline-block; margin:17px 5px 0 0; vertical-align:middle; font-size:8pt; color:#231f20;"><span style="display:inline-block; width:16px; height:16px; border:1.3px solid #231f20; margin:-5px 4px; 0 0"></span>Discover</div>
                    <div style="margin-top:25px;">
                        <div style="width:100%; font-size:8pt; color:#231f20;">Credit Card Number<span style="display:inline-block; width:71%; border-bottom: 1px solid #231f20;margin-left:4px;"></span></div>
                    </div>
                    <div style="margin-top:10px;">
                        <div style="width:35%; font-size:8pt; color:#231f20;display:inline-block;">Exp Date<span style="display:inline-block; width:55%; border-bottom: 1px solid #231f20;margin-left:4px; text-align:center;">/</span></div>
                        <div style="width:30%; font-size:8pt; color:#231f20;display:inline-block;">CVV<span style="display:inline-block; width:71%; border-bottom: 1px solid #231f20;margin-left:4px;"></span></div>
                    </div>
                    <div style="margin-top:10px;">
                        <div style="width:100%; font-size:8pt; color:#231f20;">CC Billing Zip Code<span style="display:inline-block; width:25%; border-bottom: 1px solid #231f20;margin-left:4px;"></span></div>
                    </div>
                    <div style="margin-top:10px;">
                        <div style="width:100%; font-size:8pt; color:#231f20;"><span style="display:inline-block; width:100%; border-bottom: 1px solid #231f20;margin-left:4px;"></span></div>
                        <span style="font-size:6pt; color:#231f20; margin:12px 0 0 4px; display:inline-block;">Authorized Signature</span>
                    </div>
                </td>
            </tr>

        </table>
        <!-- </apex:outputPanel> -->
        </div>
        
        
    </div>
</apex:page>